<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Creating Shiny Widgets</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="site_libs/highlight/textmate.css"
      type="text/css" />
<script src="site_libs/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>

<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.9em;
  padding-left: 5px;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
  padding-left: 10px;
}

</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R Markdown v2</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Authoring
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">R Markdown</li>
    <li>
      <a href="authoring_quick_tour.html">Quick Tour</a>
    </li>
    <li>
      <a href="authoring_basics.html">Markdown Basics</a>
    </li>
    <li>
      <a href="authoring_pandoc_markdown.html">Pandoc Markdown</a>
    </li>
    <li>
      <a href="authoring_rcodechunks.html">R Code Chunks</a>
    </li>
    <li>
      <a href="authoring_bibliographies_and_citations.html">Bibliographies &amp; Citations</a>
    </li>
    <li>
      <a href="authoring_migrating_from_v1.html">Migrating from v1</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="http://www.rstudio.com/wp-content/uploads/2016/03/rmarkdown-cheatsheet-2.0.pdf">Cheat Sheet [PDF]</a>
    </li>
    <li>
      <a href="http://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf">Reference Guide [PDF]</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Websites</li>
    <li>
      <a href="rmarkdown_websites.html">R Markdown Websites</a>
    </li>
    <li>
      <a href="rmarkdown_site_generators.html">Custom Site Generators</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Shiny</li>
    <li>
      <a href="authoring_shiny.html">Interactive Documents</a>
    </li>
    <li>
      <a href="authoring_embedded_shiny.html">Embedded Shiny Apps</a>
    </li>
    <li>
      <a href="authoring_shiny_widgets.html">Creating Shiny Widgets</a>
    </li>
    <li>
      <a href="authoring_shiny_advanced.html">Advanced Topics</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Formats
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Documents</li>
    <li>
      <a href="html_document_format.html">HTML</a>
    </li>
    <li>
      <a href="pdf_document_format.html">PDF</a>
    </li>
    <li>
      <a href="word_document_format.html">Word</a>
    </li>
    <li>
      <a href="odt_document_format.html">ODT</a>
    </li>
    <li>
      <a href="rtf_document_format.html">RTF</a>
    </li>
    <li>
      <a href="markdown_document_format.html">Markdown</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Presentations</li>
    <li>
      <a href="ioslides_presentation_format.html">ioslides</a>
    </li>
    <li>
      <a href="revealjs_presentation_format.html">reveal.js</a>
    </li>
    <li>
      <a href="slidy_presentation_format.html">Slidy</a>
    </li>
    <li>
      <a href="beamer_presentation_format.html">Beamer</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Other</li>
    <li>
      <a href="tufte_handout_format.html">Tufte Handout</a>
    </li>
    <li>
      <a href="package_vignette_format.html">Package Vignette</a>
    </li>
    <li>
      <a href="github_document_format.html">GitHub Document</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Developer
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="developer_html_widgets.html">HTML Widgets</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="developer_parameterized_reports.html">Parameterized Reports</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="developer_document_templates.html">Document Templates</a>
    </li>
    <li>
      <a href="developer_custom_formats.html">Creating New Formats</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://github.com/rstudio/rmarkdown">R Markdown on GitHub</a>
    </li>
  </ul>
</li>
<li>
  <a href="articles.html">Articles</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rstudio/rmarkdown">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Creating Shiny Widgets</h1>

</div>


<p>Shiny widgets enable you to create re-usable Shiny components that are included within an R Markdown document using a single function call. Shiny widgets can also be invoked directly from the console (useful during authoring) and show their output within the RStudio Viewer pane or an external web browser.</p>
<div id="creating-a-shiny-widget" class="section level2">
<h2>Creating a Shiny Widget</h2>
<div id="the-shinyapp-function" class="section level3">
<h3>The shinyApp Function</h3>
<p>At their core Shiny widgets are mini-applications created using the <code>shinyApp</code> function. Rather than create a <code>ui.R</code> and <code>server.R</code> as you would for a typical Shiny application, you pass the ui and server definitions to the <code>shinyApp</code> function as arguments. For example:</p>
<pre class="r"><code>shinyApp(
  ui = fluidPage(
    selectInput(&quot;region&quot;, &quot;Region:&quot;, choices = colnames(WorldPhones)),
    plotOutput(&quot;phonePlot&quot;)
  ),
  server = function(input, output) {
    output$phonePlot &lt;- renderPlot({
      barplot(WorldPhones[,input$region]*1000, 
              ylab = &quot;Number of Telephones&quot;, xlab = &quot;Year&quot;)
    })
  },
  options = list(height = 500)
)</code></pre>
<p>The simplest type of Shiny widget is just an R function that returns a <code>shinyApp</code>.</p>
</div>
<div id="example-k-means-cluster" class="section level3">
<h3>Example: K Means Cluster</h3>
<p>The <a href="https://github.com/rstudio/rmdexamples"><strong>rmdexamples</strong></a> package includes an example of Shiny widget implemented in this fashion. The <a href="https://github.com/rstudio/rmdexamples/blob/master/R/kmeans_cluster.R"><code>kmeans_cluster</code></a> function takes a single “dataset” argument and returns a Shiny widget. You can use it within an R Markdown document like this:</p>
<pre class="markdown"><code>&#96;&#96;&#96;{r, echo = FALSE}
library(rmdexamples)
kmeans_cluster(iris)
&#96;&#96;&#96;
</code></pre>
<p>This is what the widget looks like inside a running document:</p>
<div class="figure">
<img src="images/shiny-widget-kmeans.png" />

</div>
<div id="source-code" class="section level4">
<h4>Source Code</h4>
<p>Here’s the source code for the <code>kmeans_cluster</code> function. Note the use of use of <code>options = list(height = 500)</code> in the call to <code>shinyApp</code> to control the default height of the widget when rendered inside a document.</p>
<pre class="r"><code>kmeans_cluster &lt;- function(dataset) { 
  
  require(shiny)  
  
  shinyApp(
    ui = fluidPage(
      fluidRow(style = &quot;padding-bottom: 20px;&quot;,
        column(4, selectInput(&#39;xcol&#39;, &#39;X Variable&#39;, names(dataset))),
        column(4, selectInput(&#39;ycol&#39;, &#39;Y Variable&#39;, names(dataset),
                              selected=names(dataset)[[2]])),
        column(4, numericInput(&#39;clusters&#39;, &#39;Cluster count&#39;, 3,
                               min = 1, max = 9))
      ),
      fluidRow(
        plotOutput(&#39;kmeans&#39;, height = &quot;400px&quot;)  
      )
    ),
    
    server = function(input, output, session) {
      
      # Combine the selected variables into a new data frame
      selectedData &lt;- reactive({
        dataset[, c(input$xcol, input$ycol)]
      })
      
      clusters &lt;- reactive({
        kmeans(selectedData(), input$clusters)
      })
      
      output$kmeans &lt;- renderPlot(height = 400, {
        par(mar = c(5.1, 4.1, 0, 1))
        plot(selectedData(),
             col = clusters()$cluster,
             pch = 20, cex = 3)
        points(clusters()$centers, pch = 4, cex = 4, lwd = 4)
      })
    },
    
    options = list(height = 500)
  )
}</code></pre>
</div>
</div>
<div id="widget-size-and-layout" class="section level3">
<h3>Widget Size and Layout</h3>
<p>Shiny widgets may be embedded in various places including standard full width pages, smaller columns within pages, and even HTML5 presentations. The following guidelines will help ensure that widget size and layout works well in all of these contexts:</p>
<ol style="list-style-type: decimal">
<li><p>Use <code>fluidPage</code> with the <code>responsive = FALSE</code> parameter. This ensures that as the width of a widget gets smaller that elements within it scale smaller as well (and don’t wrap).</p></li>
<li><p>Ensure that the total height of the widget is no larger than 500 pixels. This isn’t a hard and fast rule, but HTML5 slides can typically only display content &lt;= 500px so if you want your widget to be usable within presentations this is a good guideline to follow.</p></li>
</ol>
<p>The example above follows both of these guidelines, specifying a total height of 500px and a height of 400px for the plot (to leave room for the controls above it). Note that height should be specified both on the <code>plotOutput</code> call as well as the <code>renderPlot</code> call.</p>
<p>Another approach would be to add an explicit height parameter to the function which creates the widget (default to 500 so it works well within slides).</p>
</div>
</div>



<!-- bizible -->
<script type="text/javascript" src="//cdn.bizible.com/scripts/bizible.js" async=""></script>


<!-- disqus -->
  <div id="disqus_thread" style="margin-top: 45px;"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'rmarkdown'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>


</body>
</html>
